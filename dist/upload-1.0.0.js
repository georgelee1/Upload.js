/** Upload.js (1.0.0) | https://github.com/georgelee1/Upload.js | MIT (https://github.com/georgelee1/Upload.js/blob/master/LICENSE) */!function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(n,"__esModule",{value:!0}),n.Widget=void 0;var a=e("../util/options"),o=e("../util/queue"),s=e("../util/dom");n.Widget=function(){function e(t,n){i(this,e),this._ele=t,this._opts=new a.Options(n,this),this._size=0,this._max=this._opts.get("max"),this._queue=new o.Queue(this._next,{delay:this._opts.get("delay")}),this._parser=new s.SimpleDOMParser,this._init()}return r(e,[{key:"_init",value:function(){var e=this;(0,s.hasClass)("uploadjs")(this._ele)||(0,s.addClass)("uploadjs")(this._ele),this._picker=document.createElement("input"),this._picker.setAttribute("type","file"),this._picker.setAttribute("multiple","multiple"),this._ele.appendChild(this._picker),(0,s.on)(this._picker,"change",function(){return!0},this._picked.bind(this)),(0,s.children)((0,s.matches)((0,s.type)("img")))(this._ele).forEach(function(t){if(!e._max||e._size<e._max){var n=e._parser.parse(e._opts.get("template.item"));(0,s.attr)("src",t.getAttribute("src"))((0,s.children)((0,s.type)("img"))(n)),e._parser.parse(e._opts.get("template.actions")).appendTo(n.items),n.appendTo(e._ele),e._size++}t.remove()}),this._add=this._parser.parse(this._opts.get("template.add")).appendTo(this._ele),!this._max&&this._size<this._max&&(0,s.addClass)("hide")(this._add),(0,s.on)(this._ele,"click",(0,s.matchesOrChild)((0,s.hasClass)("item","new")),this._picker.click.bind(this._picker)),(0,s.on)(this._ele,"click",(0,s.matchesOrChild)((0,s.hasClass)("del")),this._delete.bind(this))}},{key:"_picked",value:function(){for(var e=this,t=this._picker.files,n=function(n){var i=e._parser.parse(e._opts.get("template.item"));(0,s.addClass)("uploading")(i),e._parser.parse(e._opts.get("template.uploading")).appendTo(i);var r=new FileReader;r.onload=function(e){(0,s.attr)("src",e.target.result)((0,s.children)((0,s.type)("img"))(i))},r.readAsDataURL(t[n]),i.before(e._add)},i=0;i<t.length;i++)n(i)}},{key:"_delete",value:function(e){}}]),e}()},{"../util/dom":4,"../util/options":5,"../util/queue":6}],2:[function(e,t,n){"use strict";function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){var n={};return Object.keys(e).forEach(function(t){"object"===i(e[t])?n[t]=a({},e[t]):n[t]=e[t]}),Object.keys(t).forEach(function(e){e in n&&"object"===i(n[e])&&"object"===i(t[e])?n[e]=a(n[e],t[e]):n[e]=t[e]}),n}var o=e("./ui/widget"),s={template:{item:"div.item (img)",add:"div.item.new (div.icon.plus)",actions:"div.actions (div.action.bin (div.trash))",deleting:"div.spinner div.icon.trash",uploading:"div.spinner div.icon.upload div.progress",done:"div.icon.done (i)",error:"div.icon.error (i)"},max:0,deletable:!0,url:{upload:"...","delete":"..."},types:{images:["image/jpg","image/jpeg","image/png","image/gif"]},allowed_types:["images"]};window.UploadJs=function u(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,u),new o.Widget(e,a(s,t))}},{"./ui/widget":1}],3:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(n,"__esModule",{value:!0});n.Cache=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0];i(this,e),this._max=t,this._map={},this._head={},this._tail={prev:this._head},this._head.next=this._tail,this.length=0}return r(e,[{key:"get",value:function(e){var t=this._map[e];return this._insertAtTail(t),t?t.val:void 0}},{key:"put",value:function(e,t){this._max>0&&this.length>0&&this.length==this._max&&this.remove(this._head.next.key);var n=this._map[e],i=!0;return n?(n.val=t,i=!1):(n={key:e,val:t},this._map[e]=n,this.length++),this._insertAtTail(n),i}},{key:"remove",value:function(e){var t=this._map[e];return t?(delete this._map[e],this._evict(t),this.length--,t.val):void 0}},{key:"_evict",value:function(e){if(e){var t=e.prev,n=e.next;t.next=n,n.prev=t}}},{key:"_insertAtTail",value:function(e){e&&(e.next&&this._evict(e),e.prev=this._tail.prev,e.prev.next=e,e.next=this._tail,this._tail.prev=e)}}]),e}()},{}],4:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function a(e,t){var n=[];Array.isArray(e)?n=e:Array.isArray(e.items)?n=e.items:n.push(e),n.forEach(t)}function o(e){return function(t){return t.tagName.toUpperCase()===e.toUpperCase()}}function s(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){var n=(e.className||"").split(" ");return t.every(function(e){return n.indexOf(e)>=0})}}function u(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){for(var n=e;n;){if(t.every(function(e){return e(n)}))return!0;n=n.parentNode}return!1}}function c(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return t.every(function(t){return t(e)})}}function l(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){var n=[];return a(e,function(e){for(var i=e.childNodes,r=function(e,r){1===i[e].nodeType&&t.every(function(t){return t(i[e])})&&n.push(i[e])},a=0,o=i.length;o>a;a++)r(a,o)}),n}}function f(e,t,n,i){a(e,function(e){e.addEventListener(t,function(e){n(e.target)&&i(e)})})}function h(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=function i(n){return a(n,function(n){var i=n.className?n.className.split(" "):[];if(t)i.push(e);else{var r=i.indexOf(e);r>=0&&i.splice(r,1)}n.className=i.join(" ")}),i};return n}function p(e){return h(e,!0)}function d(e){return h(e,!1)}function v(e,t){var n=function i(n){return a(n,function(n){"object"===("undefined"==typeof e?"undefined":r(e))?Object.keys(e).forEach(function(t){"undefined"==typeof e[t]?n.removeAttribute(t):n.setAttribute(t,e[t])}):"undefined"==typeof t?n.removeAttribute(e):n.setAttribute(e,t)}),i};return n}var m=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(n,"__esModule",{value:!0}),n.DOMList=n.SimpleDOMParser=void 0,n.type=o,n.hasClass=s,n.matchesOrChild=u,n.matches=c,n.children=l,n.on=f,n.addClass=p,n.removeClass=d,n.attr=v;var _=e("./cache"),g=(n.SimpleDOMParser=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?10:arguments[0];i(this,e),this._cache=new _.Cache(t)}return m(e,[{key:"parse",value:function(e){var t=this._cache.get(e);return t||(t=new g(this._build(e)),this._cache.put(e,t)),t.clone()}},{key:"_build",value:function(e){var t=[],n=!1,i=[];if(e.split(/(\s*[ \s\(\)]\s*)/).forEach(function(e){var r=e.trim();if(0!==r.length)if(")"===r){var a=i.pop();if(!a)throw"ExpressiveDOMParser: Invalid location for closing parenthesis";n=a.node,t.forEach(function(e){return n.appendChild(e)}),t=a.nodes}else if("("===r){if(!n)throw"ExpressiveDOMParser: Invalid location for opening parenthesis";i.push({node:n,nodes:t}),t=[]}else{var o=r.split("."),s=o.shift();n=document.createElement(s),o.length&&(n.className=o.join(" ")),t.push(n)}}),i.length)throw"ExpressiveDOMParser: Unmatched opening and closing parenthesis";return t}}]),e}(),n.DOMList=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];i(this,e),this.items=t}return m(e,[{key:"clone",value:function(){var t=[];return this.items.forEach(function(e){t.push(e.cloneNode(!0))}),new e(t)}},{key:"apply",value:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];return n.forEach(function(t){e.items.forEach(function(e){t(e)})}),this}},{key:"appendTo",value:function(e){var t=this;return a(e,function(e){t.items.forEach(function(t){e.appendChild(t)})}),this}},{key:"before",value:function(e){var t=this;return a(e,function(e){t.items.forEach(function(t){e.parentNode.insertBefore(t,e)})}),this}}]),e}())},{"./cache":3}],5:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(n,"__esModule",{value:!0});n.Options=function(){function e(t,n){i(this,e),this._opts=t,this._context=n||this}return r(e,[{key:"get",value:function(e,t){var n=this._opts;if(e.split(".").forEach(function(e){n=n[e]}),"function"!=typeof n&&(n=function(e){return function(){return e}}(n)),n.length>0){var i=void 0;return n.apply(this._context,[t||function(e){i=e}]),i}return t?void t.apply(this._context,[n.apply(this._context)]):n.apply(this._context)}}]),e}()},{}],6:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(n,"__esModule",{value:!0});n.Queue=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,e),this._handler=t,this._concurrency=Math.max(n.concurrency,1)||1,this._delay=Math.max(n.delay,0)||0,this._size=Math.max(n.size,0)||0,this._queue=[],this._working=[],this._id=0}return r(e,[{key:"offer",value:function(e){return!this._size||this._queue.length<this._size?(this._queue.push({item:e}),this._next(),!0):!1}},{key:"_next",value:function(){var e=this;this._working.length<this._concurrency&&!function(){var t=e._queue.shift();void 0!==t&&!function(){var n=++e._id,i=function(){var t=e._working.indexOf(n);t>=0&&(e._working.splice(t,1),e._next())},r=function(){e._handler.apply(e,[t.item,i])};e._working.push(n),e._delay?setTimeout(r,e._delay):r()}()}()}}]),e}()},{}]},{},[2]);